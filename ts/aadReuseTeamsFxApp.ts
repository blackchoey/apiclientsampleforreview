// This file is auto generated by Teams Toolkit to provide you instructions and reference code to call your api.

/*
Your next steps:
1. Run npm install. If your project did not install @microsoft/teamsfx package before, we have added it to package.json for you.
   You need to run the command under "bot" folder instead of project's root folder.
2. Replace "<your-api-scope>" in this file with actual scope required by the API.
3. Refer https://aka.ms/teamsfx-connect-api-with-aad for configuring AAD app and consent scopes.

You can now import the API client (an Axios instance) in another file and call aadReuseCurrentApp APIs without worrying about authentication.
Here is an example for a GET request to "relative_path_of_target_api":
```
import { aadReuseCurrentAppClient } from "relative_path_to_this_file";

const response = await aadReuseCurrentAppClient.get("relative_path_of_target_api");
// You only need to enter the relative path for your API.
// For example, if you want to call api https://my-api-endpoint/test, and inputted https://my-api-endpoint as API endpoint,
// the code will looks like: const response = await aadReuseCurrentAppClient.get("test");

const responseBody = response.data;
```

You can refer https://aka.ms/teamsfx-connect-api to learn more.
*/
import {
  TeamsFx,
  createApiClient,
  BearerTokenAuthProvider,
  IdentityType,
} from "@microsoft/teamsfx";

// Loads current app's configuration, the sample uses client credential flow to acquire token for your API.
const teamsFx = new TeamsFx(IdentityType.App);
// Initializes a new axios instance to call aadReuseCurrentApp API.
const appCredential = teamsFx.getCredential();
const authProvider = new BearerTokenAuthProvider(
  // TODO: Please replace '<your-api-scope>' with actual api scope value.
  async () => (await appCredential.getToken("<your-api-scope>"))!.token
);
const aadReuseCurrentAppClient = createApiClient(
  teamsFx.getConfig("TEAMSFX_API_AADREUSECURRENTAPP_ENDPOINT"),
  authProvider
);
export { aadReuseCurrentAppClient };

/* 
Setting API configuration for cloud environment: 
We have already set the configuration to .env.teamsfx.local based on your answers. 
Before you deploy your code to cloud using TeamsFx, please follow https://aka.ms/teamsfx-add-appsettings to add following app settings with appropriate value to your Azure environment: 
TEAMSFX_API_AADREUSECURRENTAPP_ENDPOINT

You can refer https://aka.ms/teamsfx-connect-api to learn more. 
*/